import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import cm

x = [[0, 0, 3, 9, 19, 33, 37, 57, 58, 67, 62, 62, 48, 20, 35],
[0, 0, 6, 8, 23, 42, 72, 93, 117, 128, 116, 113, 88, 75, 35],
[3, 9, 24, 52, 87, 122, 158, 225, 245, 244, 237, 207, 134, 111, 62],
[0, 8, 22, 46, 94, 161, 230, 307, 349, 344, 330, 289, 232, 158, 76],
[5, 15, 46, 80, 148, 186, 278, 359, 407, 418, 363, 328, 227, 149, 65],
[6, 22, 37, 95, 167, 258, 354, 486, 533, 529, 501, 423, 302, 215, 101],
[23, 45, 107, 161, 280, 360, 461, 612, 669, 633, 554, 500, 338, 234, 106],
[10, 37, 95, 189, 316, 481, 621, 756, 858, 840, 751, 634, 501, 319, 116],
[41, 79, 146, 227, 351, 436, 585, 729, 808, 764, 672, 570, 394, 272, 74],
[4, 48, 105, 208, 339, 503, 587, 730, 796, 727, 646, 523, 432, 253, 96],
[14, 44, 103, 132, 259, 354, 434, 523, 596, 579, 478, 418, 294, 196, 41],
[12, 46, 87, 174, 256, 345, 413, 497, 511, 471, 425, 301, 243, 159, 61],
[42, 76, 109, 165, 261, 325, 396, 477, 488, 435, 362, 267, 197, 144, 35],
[0, 35, 84, 155, 227, 316, 364, 370, 377, 352, 298, 214, 174, 94, 21],
[0, 0, 0, 30, 54, 95, 141, 180, 224, 195, 165, 116, 60, 27, 0]]

h = [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 3, 0, 0, 117, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -76, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

def otklik_svertka(x, h):
   n1, n2 = len(h), len(h[0])
   m1, m2 = len(x), len(x[0])
   l1, l2 = n1 + m1 - 1, n2 + m2 - 1
   y = np.zeros((l1, l2), dtype=int)

   for i in range(l1):
       for j in range(l2):
           for k1 in range(l1):
               for k2 in range(l2):
                   if (k1 < m1) and (k2 < m2) and (0 <= i - k1 < n1) and (0 <= j - k2 < n2):
                       y[i][j] += x[k1][k2] * h[i - k1][j - k2]

   return y


def otklik_summa(x, h):
   n1, n2 = len(h), len(h[0])
   m1, m2 = len(x), len(x[0])
   l1, l2 = n1 + m1 - 1, n2 + m2 - 1
   y = np.zeros((l1, l2), dtype=int)

   for i in range(m1):
       for j in range(m2):
           y[i:i + n1, j:j + n2] += np.array(h) * x[i][j]

   return y


def plot3d(y):
   xs = [[i for i in range(len(y[0]))] for _ in range(len(y))]
   ys = [[i for _ in range(len(y[0]))] for i in range(len(y))]

   fig = plt.figure()
   ax = fig.add_subplot(projection='3d')
   surf = ax.plot_surface(xs, ys, y, cmap=cm.coolwarm)
   fig.colorbar(surf, shrink=0.5, aspect=5)

   fig2 = plt.figure()
   ax2 = fig2.gca()
   cnt = ax2.contourf(xs, ys, y, cmap=cm.coolwarm)
   fig2.colorbar(cnt, shrink=0.7, aspect=10)
   plt.show()


y1 = otklik_svertka(x, h)
print(y1)
y2 = otklik_summa(x, h)
print(y2)
plot3d(y1)


