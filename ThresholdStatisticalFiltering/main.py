import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import cm

x = [[14,  26,  22,   53,   46,  78,  108,  91,  79,  59,  59,  45,  28,  12,  0],
[6,  28,  47,   78,   100,  99,  121,  176,  145, 134, 113, 72, 84,  41,  14],
[30,  62,  69,  136,  131,  206, 232, 274, 268, 199, 190, 142, 108, 79, 47],
[28,  89,  127,  187,  259,  271, 330, 435, 348, 293, 265, 177, 153, 104, 77],
[28,  83, 107,  177,  248, 306, 377, 407, 427, 332, 311, 241, 174, 109, 88],
[31,  88, 152,  216,  329, 396, 477, 582, 576, 465, 416, 297, 265, 127, 90],
[42, 108, 153, 237, 387, 489, 601, 656, 633, 516, 493, 330, 249, 146, 111],
[45, 104, 167,  284, 400, 567, 656, 746, 695, 600, 555, 410, 301, 218, 116],
[38, 92, 157, 258, 397, 502, 553, 687, 604, 583, 454, 401, 246, 204, 147],
[43,  101, 135, 238, 289, 406, 438, 572, 527, 421, 400, 300, 248, 140, 106],
[25, 73, 92, 155, 226, 316, 390, 469, 496, 380, 397, 267, 233, 130, 94],
[8, 35, 47,  94, 162, 211, 318, 338, 388, 295, 308, 234, 169, 99, 44],
[10, 27, 60, 102, 161, 197, 277, 302, 309, 291, 255, 204, 132, 87, 56],
[16,  35, 55,  88, 126, 159, 184, 236, 200, 213, 161, 154, 88, 61,  36],
[8,  18,  20,   40,  48,  60,  70, 90, 82, 72, 76, 52, 48,  24,  28]]

h = [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, -24, 0, 0, 99, 0, 0, 46, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

def otklik_svertka(x, h):
   n1, n2 = len(h), len(h[0])
   m1, m2 = len(x), len(x[0])
   l1, l2 = n1 + m1 - 1, n2 + m2 - 1
   y = np.zeros((l1, l2), dtype=int)

   for i in range(l1):
       for j in range(l2):
           for k1 in range(l1):
               for k2 in range(l2):
                   if (k1 < m1) and (k2 < m2) and (0 <= i - k1 < n1) and (0 <= j - k2 < n2):
                       y[i][j] += x[k1][k2] * h[i - k1][j - k2]

   return y


def otklik_summa(x, h):
   n1, n2 = len(h), len(h[0])
   m1, m2 = len(x), len(x[0])
   l1, l2 = n1 + m1 - 1, n2 + m2 - 1
   y = np.zeros((l1, l2), dtype=int)

   for i in range(m1):
       for j in range(m2):
           y[i:i + n1, j:j + n2] += np.array(h) * x[i][j]

   return y


def plot3d(y):
   xs = [[i for i in range(len(y[0]))] for _ in range(len(y))]
   ys = [[i for _ in range(len(y[0]))] for i in range(len(y))]

   fig = plt.figure()
   ax = fig.gca(projection='3d')
   surf = ax.plot_surface(xs, ys, y, cmap=cm.coolwarm)
   fig.colorbar(surf, shrink=0.5, aspect=5)

   fig2 = plt.figure()
   ax2 = fig2.gca()
   cnt = ax2.contourf(xs, ys, y, cmap=cm.coolwarm)
   fig2.colorbar(cnt, shrink=0.7, aspect=10)
   plt.show()


y1 = otklik_svertka(x, h)
print(y1)
y2 = otklik_summa(x, h)
print(y2)
plot3d(y1)


